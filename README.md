# 🌱 E와I들 - 자기개발 커뮤니티(SPROUT)

## 🧑🏻‍💻👩🏻‍💻Developers

|                                                 Frontend                                                  |                                                 Frontend                                                  |                                                 Frontend                                                  |                                                 Frontend                                                  |                                                 Frontend                                                  |
| :-------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------: | :-------------------------------------------------------------------------------------------------------: |
| <img src="https://github.com/user-attachments/assets/5da96811-cf1c-4a90-b8d0-f32a2c963d63"  width="100"/> | <img src="https://github.com/user-attachments/assets/72e19e75-5d88-453e-9dbf-66d8cfff57b4"  width="100"/> | <img src='https://github.com/user-attachments/assets/9fe42332-5c5f-4992-90ed-a3250b445e5a'  width="100"/> | <img src="https://github.com/user-attachments/assets/ecfdea20-5919-4044-af7b-d034f8e01ce7"  width="100"/> | <img src="https://github.com/user-attachments/assets/ff874a01-a97b-45b0-ac65-44c4c6ef1d7f"  width="100"/> |
|                                                  김동찬                                                   |                                                  박선형                                                   |                                                  이수빈                                                   |                                                  이준영                                                   |                                                  정현승                                                   |
|                                  [@kdc9050](https://github.com/kdc9050)                                   |                              [@sunhyeongpp](https://github.com/sunhyeongpp)                               |                           [@ddongguri-bing](https://github.com/ddongguri-bing)                            |                                 [@osanThor](https://github.com/osanThor)                                  |                                  [@denshou](https://github.com/denshou)                                   |

<br/>

## 💻 Tech Stack

### Project setting

<img src="https://img.shields.io/badge/npm-CB3837?style=for-the-badge&logo=npm&logoColor=white"> <img src="https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=react&logoColor=black"> <img src="https://img.shields.io/badge/ReactRouter-CA4245?style=for-the-badge&logo=reactrouter&logoColor=white"> <img src="https://img.shields.io/badge/Typescript-3178C6?style=for-the-badge&logo=typescript&logoColor=white"> <img src="https://img.shields.io/badge/TailwindCSS-06B6D4?style=for-the-badge&logo=tailwindcss&logoColor=white"> <img src="https://img.shields.io/badge/Axios-5A29E4?style=for-the-badge&logo=axios&logoColor=white">

### React Compiler

  <img src="https://img.shields.io/badge/SWC-F8C457?style=for-the-badge&logo=swc&logoColor=black">

### Design

  <img src="https://img.shields.io/badge/figma-F24E1E?style=for-the-badge&logo=figma&logoColor=white">

### Etc

<img src="https://img.shields.io/badge/notion-000000?style=for-the-badge&logo=notion&logoColor=white"> <img src="https://img.shields.io/badge/slack-4A154B?style=for-the-badge&logo=slack&logoColor=white"> <img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">

<br/>

## 📝 Code Convention

### Commit Message

- [FEAT]: 코드 새로운 기능 구현.
- [FIX]: 코드 버그 수정.
- [REFACTOR]: 코드의 기능을 바꾸지 않고 코드 구조를 개선.
- [STYLE]: 코드 포맷팅(세미콜론 누락 수정, 코드 로직 변경이 없는 경우).
- [DOCS]: 문서 수정.
- [CONF]: 프로젝트 설정 파일 변경(설정 중심).
- [CHORE]: 개발 환경 설정(일반적인 유지 관리나 작업).
- [DESIGN]: csse등 UI 디자인 변경.
- [RENAME]: 파일 명/폴더 명을 수정.
- [REMOVE]: 코드(파일)의 삭제.
- [COMMENT]: 필요한 주석 추가 및 변경.

<br/>

## ✅ Implementation List

### 기본 요구사항

- [x] 사용자는 **회원가입과 로그인**을 할 수 있습니다.
- [x] 사용자는 **채널에 올라온 글**을 볼 수 있습니다.
- [x] 사용자는 **가입자 목록**을 볼 수 있습니다.
- [x] 사용자는 **가입자를 이름**으로 **검색**을 할 수 있습니다.
- [x] 사용자는 **가입자의 정보**를 볼 수 있습니다.
- [x] 사용자는 **포스트 혹은 가입자를 검색**할 수 있습니다.
- [x] 인증된 사용자는 **자신의 정보를 변경**할 수 있습니다.
- [x] 인증된 사용자는 **채널에 올라온 글**을 볼 수 있습니다.
- [x] 인증된 사용자는 **채널에 포스트를 남길 수** 있습니다.
- [x] 인증된 사용자는 **포스트를 좋아요** 할 수 있습니다.
- [x] 인증된 사용자는 **포스트에 댓글**을 남길 수 있습니다.
- [x] 인증된 사용자는 **자신의 알림 목록을 확인** 할 수 있습니다.
- [x] **SPA 형태**로 제작 하였습니다.
- [x] 엉뚱한 페이지에 접속하면 **404 페이지**가 출력됩니다.

### 보너스 요구사항

- [x] 다크 모드를 적용할 수 있습니다.
- [x] 인증된 사용자는 프로필 이미지 변경 및 포스트를 작성할 때 이미지를 첨부할 수 있습니다.
- [x] 사용자는 현재 접속 중인 사용자를 볼 수 있습니다.
- [x] 인증된 사용자는 다른 가입자에게 메시지를 보낼 수 있습니다.
- [x] 인증된 사용자는 자신에게 온 메시지 목록을 확인 할 수 있습니다.
- [x] 인증된 사용자는 특정 사용자와의 메시지 대화 내역을 확인 할 수 있습니다.
- [x] 이미지 클릭 시 원본 이미지를 확인할 수 있습니다.
- [x] 게시판 목록를 스크롤하여 마지막 포스트를 확인할 수 있습니다(무한 스크롤).
- [x] 텍스트 에디터로 다양한 텍스트 스타일을 적용할 수 있습니다.
- [x] OAuth 사용한 소셜 로그인으로 간단하게 가입할 수 있습니다.
- [x] 반응형으로 다양한 디바이스에서 이용할 수 있습니다.
- [x] 카카오 공유하기 기능으로 간편하게 포스트를 공유할 수 있습니다.
- [x] 다중 이미지를 업로드 할 수 있습니다.
- [x] 관리자 계정으로 로그인 시 채널을 생성 및 삭제할 수 있습니다.
- [x] 다른 사용자를 팔로우/언팔로우 할 수 있습니다.
- [x] 경고 메세지 출력 시 커스텀 모달이 출력됩니다.

## 🗂️ Folder

```
  📦public
  📦src
 ┣ 📂api
 ┣ 📂assets
 ┣ 📂components
 ┃ ┣ 📂board
 ┃ ┣ 📂common
 ┃ ┃ ┣ 📂skeleton
 ┃ ┣ 📂search
 ┃ ┣ 📂ui
 ┃ ┗ 📂user
 ┣ 📂constants
 ┣ 📂hooks
 ┣ 📂layouts
 ┣ 📂pages
 ┣ 📂stores
 ┣ 📂styles
 ┣ 📂types
 ┗ 📂utils
```

## 🔥 Trouble Shooting

### 1. Token 관리

#### 방법 검토
1. **쿠키**를 사용
   - 장점: 브라우저 탭 간 이동이나 브라우저를 닫았다 열어도 토큰(로그인 상태)이 유지됨
   - 단점: XSS(Cross-Site Scripting) 공격에 취약하기 때문에, HttpOnly 옵션을 반드시 설정해야 하나, 현재 백엔드가 이를 지원하지 않는 상황

2. **Persist 미들웨어와 세션스토리지** 사용
   - 장점: 로그인 후 사용자 정보를 불러올 때, 렌더링 전에 사용자 정보를 미리 가져올 수 있어 사용자 경험(UX)을 향상시킴
   - 단점: 세션스토리지는 브라우저 탭 간 정보가 공유되지 않으므로, 탭 이동 시 로그인 상태가 유지되지 않는 한계가 있음

3. **Persist 미들웨어와 로컬스토리지** 사용
   - 장점: 간단히 토큰을 저장하고 유지할 수 있으며, 브라우저를 닫아도 데이터가 남아 있어 장기적으로 상태를 유지함
   - 단점: 로그아웃하지 않으면 토큰이 로컬스토리지에 계속 남아 있어 보안에 취약함. (특히, XSS 공격에 민감하게 노출됨.)

#### 결론
  리액트 쿠키와 세션스토리지를 함께 활용하여 보안성과 사용자 경험을 모두 충족하고자 함
  => 리액트 쿠키: 유효시간(expiration time)을 설정하여 토큰 만료를 관리함. 추후 백엔드에서 HttpOnly 처리가 가능해지면, 보안성을 더욱 강화할 수 있을 것으로 기대

![스크린샷 2024-12-23 오후 3 16 28 1](https://github.com/user-attachments/assets/c9bbe194-b859-4da7-9be7-0efa7a667d57)
![스크린샷 2024-12-23 오후 2 57 00 1](https://github.com/user-attachments/assets/5c70ae1f-3ec9-4ba9-a00e-bca6c0a4fef2)

=> Zustand Persist: 렌더링 전에 사용자 정보를 불러오는 기능을 제공하여, 로그인 직후 사용자 정보가 없는 상태의 화면이 잠깐 표시되는 문제를 해결함.
![스크린샷 2024-12-23 오후 3 15 18 1](https://github.com/user-attachments/assets/cf2ad68e-f6ec-4a5d-9ed7-44766107662a)

### 2. 무한 스크롤 구현 (Intersection Observer 사용)

#### Intersection Observer를 사용한 이유

**장점**
1. 비동기적 처리
    - 스크롤 이벤트는 매우 자주 발생하므로, 이를 처리할 때 성능 문제가 발생할 수 있습니다. 반면, Intersection Observer는 지정된 요소가 화면에 보일 때만 실행되어 불필요한 계산을 줄이고 성능을 최적화합니다.
2. 성능 우수
    - 특정 요소가 뷰포트에 나타날 때만 이벤트가 발생하므로, 스크롤 이벤트를 계속 처리하는 것보다 효율적입니다.

####  문제점 및 해결 방법
1. 게시글 클릭 후 뒤로 가기 시 스크롤과 게시글 초기화
    - 문제: 게시글을 클릭하고 뒤로 가기를 하면, 이전에 저장된 스크롤 위치나 게시글 상태가 초기화됩니다.
    - 해결:
    sessionStorage에 offset과 scrollY 값을 저장하여 페이지가 새로고침되거나 뒤로가기 할 때 이를 복원합니다.
    scrollY는 ref에 저장하여 불필요한 리렌더링을 방지하고 성능을 최적화합니다.
    세션 저장: 스크롤 위치가 변경될 때마다 scrollYRef 값을 갱신하고, offset과 scrollY를 sessionStorage에 저장합니다.
    만약 뒤로가기로 페이지에 접근하였다면  (navigationType === "POP" 이라면)  sessionStorage에서 값을 불러와 데이터를 fetch 합니다.

2. 새로고침 시 불러오는 데이터 수가 증가하는 문제
    - 문제: 새로고침 후 offset이 증가한 상태에서 데이터를 불러오는 문제가 발생합니다.
    - 해결:
    만약 처음 데이터를 불러오는 것이라면 loadMoreItems를 실행하지 않도록 합니다.
    새로고침 시, scrollState가 없는 경우 기본적으로 6개의 데이터만 로드하도록 설정합니다.
    만약 scrollState가 존재한다면, 이를 기반으로 데이터를 로드합니다.

3. sessionStrage에 scrollState가 없을 경우 데이터를 정상적으로 fetch하지 못하는 문제
    - scrollState가 있을 경우에만 scrollState를 가져와서 데이터를 fetch하고, (restoreScrollAndFetchData) scrollState가 없다면 데이터를 6개씩 fetch하도록 수정

#### 구현 완료
  세션에 scrollState가 없으면 기본적으로 6개의 데이터만 가져오고
   scrollState가 저장되어있다면 저장되어있는 정보를 기반으로 데이터를 불러옵니다.
   만약 다른페이지로 이동한다면 세션에서 scrollState를 제거합니다.

### 3. 토글 이벤트 불필요한 HTTP 요청 처리

#### 문제
좋아요 / 팔로우 등 토글 이벤트의 경우
반복적인 HTTP 요청은 서버에 불필요한 부담

#### 해결
1. debounce를 이용해서 서버의 요청을 최소화
2. useEffect의 의존성으로 debounce값 사용시 불필요한 요청이
발견되어 분기처리를 따로 설정 
3. 분기 기준은 렌더링의 영향을 주지 않는 useRef를 사용해서 
렌더링 최적화

#### 결과
<table>
  <tbody>
     <tr>
      <td align="center">최적화 이전</td>
      <td align="center">최적화 이후</td>
    </tr>
    <tr>
      <td>
         <img src="https://github.com/user-attachments/assets/4ea8e7f8-0c7a-4a1b-ab79-a34884b529d0" />
      </td>
      <td>
         <img src="https://github.com/user-attachments/assets/a82d015c-0123-4e20-a74e-35ab7cbb72cc" />
      </td>
    </tr>
  </tbody>
</table>


## 🌟 Result


<table>
  <tbody>
     <tr>
      <td align="center">Light Mode</td>
      <td align="center">Dark Mode</td>
    </tr>
    <tr>
      <td>
         <img src="https://github.com/user-attachments/assets/5f7168f2-72ce-45b9-8297-1135be980298" alt="ligt mode" />
      </td>
      <td>
         <img src="https://github.com/user-attachments/assets/cbbda959-a41e-462e-babb-d6098827b2d7" alt="dark mode" />
      </td>
    </tr>
  </tbody>
</table>



### Preview

<table>
  <tbody>
    <tr>
      <td align="center">메인페이지</td>
      <td align="center">로그인</td>
      <td align="center">회원가입</td>
      <td align="center">유저프로필</td>
    </tr>
    <tr>
      <td>
          <img src="https://github.com/user-attachments/assets/5f7168f2-72ce-45b9-8297-1135be980298" style="width:230px"/>
      </td>
      <td>
          <img src="https://github.com/user-attachments/assets/c4fca89d-5fb7-4293-bafd-786cf9008263" style="width:230px"/>
      </td>
      <td>
          <img src="https://github.com/user-attachments/assets/e5f7232d-5f92-4dd7-a8a0-eaf265ebf5ca" style="width:230px"/>
      </td>
      <td>
          <img src="https://github.com/user-attachments/assets/7f0a8792-8a27-4873-80d8-b66b4b0712a9" style="width:230px"/>
      </td>
    </tr>
    <tr>
      <td align="center">마이페이지</td>
      <td align="center">게시판</td>
      <td align="center">게시글</td>
      <td align="center">게시글 작성/수정</td>
    </tr>
    <tr>
      <td>
          <img src="https://github.com/user-attachments/assets/6d0d397b-d9aa-4edf-9f26-b0af0a4c952e" style="width:230px"/>
      </td>
      <td>
          <img src="https://github.com/user-attachments/assets/4b7a3346-1bb4-491f-bdc7-7f5ead3d4b90" style="width:230px"/>
      </td>
      <td>
          <img src="https://github.com/user-attachments/assets/c86e804c-a889-43eb-a991-f62b479a1d36" style="width:230px"/>
      </td>
      <td>
          <img src="https://github.com/user-attachments/assets/af1fdb28-bf0f-4227-b0f8-b1ce7e7efd07" style="width:230px"/>
      </td>
    </tr>
  </tbody>
</table>

<div align='center'>
  <a href="https://programmers-sprout.netlify.app/">
    <img src="https://github.com/user-attachments/assets/d2eb6d2c-56e8-43f7-b542-1c21cc9eb9a0" alt="sprout logo" />
  </a>
</div>


